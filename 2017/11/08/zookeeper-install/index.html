<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>zookeeper安装教程 | Leeyom的个人站</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="zookeeper安装教程。">
<meta name="keywords" content="zookeeper">
<meta property="og:type" content="article">
<meta property="og:title" content="zookeeper安装教程">
<meta property="og:url" content="http://leeyom.top/2017/11/08/zookeeper-install/index.html">
<meta property="og:site_name" content="Leeyom的个人站">
<meta property="og:description" content="zookeeper安装教程。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-12-19T14:01:15.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="zookeeper安装教程">
<meta name="twitter:description" content="zookeeper安装教程。">
  
    <link rel="alternative" href="/atom.xml" title="Leeyom的个人站" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/avatar.png" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">Leeyom</a></h1>
        </hgroup>

        
        <p class="header-subtitle">永远年轻，永远热泪盈眶</p>
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">归档</a></li>
                        
                            <li><a href="/tags/">分类</a></li>
                        
                            <li><a href="/about/">关于</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github" target="_blank" href="https://github.com/wangleeyom/" title="github">github</a>
                            
                                <a class="fl zhihu" target="_blank" href="https://www.zhihu.com/people/leeyomwang" title="zhihu">zhihu</a>
                            
                                <a class="fl weibo" target="_blank" href="http://weibo.com/u/1816623124?refer_flag=1001030201_&is_hot=1" title="weibo">weibo</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/ActiveMQ/" style="font-size: 10px;">ActiveMQ</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Excepition/" style="font-size: 10px;">Excepition</a> <a href="/tags/FastDFS/" style="font-size: 10px;">FastDFS</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Hibernate/" style="font-size: 10px;">Hibernate</a> <a href="/tags/IntelliJ-IDEA/" style="font-size: 10px;">IntelliJ IDEA</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/PageHelper/" style="font-size: 10px;">PageHelper</a> <a href="/tags/Tomcat/" style="font-size: 10px;">Tomcat</a> <a href="/tags/chrome/" style="font-size: 10px;">chrome</a> <a href="/tags/easyUI/" style="font-size: 15px;">easyUI</a> <a href="/tags/helloWorld/" style="font-size: 10px;">helloWorld</a> <a href="/tags/hexo/" style="font-size: 20px;">hexo</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/oracle/" style="font-size: 10px;">oracle</a> <a href="/tags/spring-boot/" style="font-size: 10px;">spring boot</a> <a href="/tags/swagger2/" style="font-size: 10px;">swagger2</a> <a href="/tags/swagger注解/" style="font-size: 10px;">swagger注解</a> <a href="/tags/tomact/" style="font-size: 10px;">tomact</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/书单/" style="font-size: 10px;">书单</a> <a href="/tags/前后端分离/" style="font-size: 10px;">前后端分离</a> <a href="/tags/反向代理/" style="font-size: 10px;">反向代理</a> <a href="/tags/图床/" style="font-size: 10px;">图床</a> <a href="/tags/多模块/" style="font-size: 10px;">多模块</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/权限模型/" style="font-size: 10px;">权限模型</a> <a href="/tags/生活/" style="font-size: 10px;">生活</a> <a href="/tags/触发器/" style="font-size: 10px;">触发器</a> <a href="/tags/递归查询/" style="font-size: 10px;">递归查询</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.tlong.tv/">TLongTv</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.zealer.com/">ZEALER</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://login926.top/">Login926</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://www.sfantree.com/">popy32</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://ehlxr.me/">小桥流水人家</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://patrickphang.github.io/">Patrick&#39;s Blog</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.sunhy.top">依然安恋</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://itsay.tech">张大侠</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.mapan.win/">不思凡</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://linyy.name/">林洋洋博客</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.belongwithme.cn/">Zane的个人站</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://lzp.ucaner.cn/">lzp</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.imain.net/">曾小晨</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://www.artisanbox.org/">工匠盒子</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://yzlee666.github.io/">肥胖的猪</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">Leeyom</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/avatar.png" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">Leeyom</a></h1>
            </hgroup>
            
            <p class="header-subtitle">永远年轻，永远热泪盈眶</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">归档</a></li>
                
                    <li><a href="/tags/">分类</a></li>
                
                    <li><a href="/about/">关于</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/wangleeyom/" title="github">github</a>
                    
                        <a class="zhihu" target="_blank" href="https://www.zhihu.com/people/leeyomwang" title="zhihu">zhihu</a>
                    
                        <a class="weibo" target="_blank" href="http://weibo.com/u/1816623124?refer_flag=1001030201_&is_hot=1" title="weibo">weibo</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-zookeeper-install" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/11/08/zookeeper-install/" class="article-date">
      <time datetime="2017-11-08T13:26:06.000Z" itemprop="datePublished">2017-11-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      zookeeper安装教程
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/资源/">资源</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zookeeper/">zookeeper</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>zookeeper安装教程。</p>
<a id="more"></a>
<h1 id="系统需求"><a href="#系统需求" class="headerlink" title="系统需求"></a>系统需求</h1><h2 id="支持平台"><a href="#支持平台" class="headerlink" title="支持平台"></a>支持平台</h2><table>
<thead>
<tr>
<th style="text-align:center">系统</th>
<th style="text-align:center">开发环境</th>
<th style="text-align:center">生产环境</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Linux</td>
<td style="text-align:center">支持</td>
<td style="text-align:center">支持</td>
</tr>
<tr>
<td style="text-align:center">Solaris</td>
<td style="text-align:center">支持</td>
<td style="text-align:center">支持</td>
</tr>
<tr>
<td style="text-align:center">FreeBSD</td>
<td style="text-align:center">支持</td>
<td style="text-align:center">支持</td>
</tr>
<tr>
<td style="text-align:center">Windows</td>
<td style="text-align:center">支持</td>
<td style="text-align:center">不支持</td>
</tr>
<tr>
<td style="text-align:center">MacOS</td>
<td style="text-align:center">支持</td>
<td style="text-align:center">不支持</td>
</tr>
</tbody>
</table>
<h2 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h2><p>ZooKeeper运行在java平台，需要<strong>JRE 1.6或者以上</strong>的版本。对于集群模式下的ZooKeeper部署，3个ZooKeeper服务进程是建议的最小进程数量。</p>
<h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><ul>
<li>下载地址：<a href="http://apache.forsale.plus/zookeeper/" target="_blank" rel="noopener">http://apache.forsale.plus/zookeeper/</a>。</li>
<li>我下载的版本是<code>zookeeper-3.4.10</code>，这个版本比较稳定。</li>
</ul>
<h1 id="安装方式"><a href="#安装方式" class="headerlink" title="安装方式"></a>安装方式</h1><p>ZooKeeper有三种安装方式，分别是单机模式、集群模式、伪集群模式。</p>
<h2 id="单机模式"><a href="#单机模式" class="headerlink" title="单机模式"></a>单机模式</h2><p>将下载的<code>zookeeper-3.4.10.tar.gz</code>压缩包解压到<code>/home/leeyom/develop-tools/</code>，执行命令：</p>
<ul>
<li><code>sudo tar -zxvf zookeeper-3.4.10.tar.gz -C /home/leeyom/develop-tools/</code></li>
</ul>
<p>在<code>/etc/profile</code>文件中加入ZooKeeper的环境变量设置，具体的内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ZooKeeper</span><br><span class="line">export ZOOKEEPER_HOME=/home/leeyom/develop-tools/zookeeper-3.4.10</span><br><span class="line">export PATH=$PATH:$ZOOKEEPER_HOME/bin:$ZOOKEEPER_HOME/conf</span><br></pre></td></tr></table></figure>
<p>ZooKeeper服务器包含在单个的jar文件中，安装此服务需要用户创建一个配置文档，对其进行设置。进入ZooKeeper配置文件目录<code>/home/leeyom/develop-tools/zookeeper-3.4.10/conf</code>，该目录下面有一个参考的配置文件<code>zoo_sample.cfg</code>，可供参考。在conf目录下创建我们自己的配置文件<code>zoo.cfg</code>，内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">dataDir=/home/leeyom/develop-tools/zookeeper-3.4.10/zookeeper-data</span><br><span class="line">dataLogDir=/home/leeyom/develop-tools/zookeeper-3.4.10/zookeeper-logs</span><br><span class="line">clientPort=2181</span><br></pre></td></tr></table></figure>
<p>目录<code>/home/leeyom/develop-tools/zookeeper-3.4.10/zookeeper-data/</code>和<code>/home/leeyom/develop-tools/zookeeper-3.4.10/zookeeper-logs/</code>默认是没有创建的，需要我们自己<strong>手动创建此目录</strong>，下面是每个参数的含义：</p>
<ul>
<li><strong>tickTime</strong>：基本的时间单元，以毫秒为单位，用他来指示心跳。</li>
<li><strong>dataDir</strong>：存储内存中数据库快照的位置，如果不设置参数，更新事务日志将被存储到默认位置。</li>
<li><strong>clientPort</strong>：监听客户端连接的端口。</li>
<li><strong>dataLogDir</strong> : 保存zookeeper日志路径，当此配置不存在时默认路径与dataDir一致。</li>
</ul>
<p>单机模式下需要注意：<strong>在这种配置方式下，是没有ZooKeeper副本，如果zookeeper服务器出现故障，zookeeper服务将会停止</strong>！。</p>
<h2 id="集群模式"><a href="#集群模式" class="headerlink" title="集群模式"></a>集群模式</h2><p>为了获得可靠的zookeeper服务，我们应该在一个集群上部署zookeeper。只要集群上的大多数zookeeper服务启动了，那么总的zookeeper服务便是可用的。另外，最好使用奇数台服务器。如果zookeeper拥有5台服务器，那么在最多2台服务器出现故障后，整个服务还可以正常使用。</p>
<p>具体的安装其实跟单机模式下基本上差不多，不同之处在于每台机器上的<code>conf/zoo.cfg</code>配置文件的参数设置不同，可以参考其中一台的机器的配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">dataDir=/var/lib/zookeeper</span><br><span class="line">clientPort=2181</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">server.1=zoo1:2888:3888</span><br><span class="line">server.2=zoo2:2888:3888</span><br><span class="line">server.3=zoo3:2888:3888</span><br><span class="line">maxClientCnxns=60</span><br></pre></td></tr></table></figure>
<p>在这个配置文件中，出现几个新的参数，其含义如下：</p>
<ul>
<li><strong>initLimit</strong>：此配置表示允许follower连接并同步到leader的初始化时间，它以tickTime的倍数来表示。当超过设置倍数的tickTime时间，则连接失败。</li>
<li><strong>syncLimit</strong>：Leader服务器与follower服务器之间信息同步允许的最大时间间隔，如果超过次间隔，默认follower服务器与leader服务器之间断开链接。</li>
<li><strong>maxClientCnxns</strong>：限制连接到zookeeper服务器客户端的数量。</li>
<li><strong>server.id=host:port:port</strong>：表示了不同的zookeeper服务器的自身标识，作为集群的一部分，每一台服务器应该知道其他服务器的信息。用户可以从<code>server.id=host:port:port</code>中读取到相关信息。在服务器的data(dataDir参数所指定的目录)下创建一个文件名为myid的文件，这个文件的内容只有一行，指定的是自身的id值。比如，服务器“1”应该在myid文件中写入“1”。这个id必须在集群环境中服务器标识中是唯一的，且大小在1～255之间。这一样配置中，zoo1代表第一台服务器的IP地址。第一个端口号（port）是从follower连接到leader机器的端口，第二个端口是用来进行leader选举时所用的端口。所以，在集群配置过程中有三个非常重要的端口：<strong>clientPort：2181、port:2888、port:3888</strong>。</li>
</ul>
<h2 id="伪集群模式"><a href="#伪集群模式" class="headerlink" title="伪集群模式"></a>伪集群模式</h2><p>伪集群模式就是在单机环境下模拟集群的Zookeeper服务。</p>
<p>在zookeeper集群配置文件中，clientPort参数用来设置客户端连接zookeeper服务器的端口。server.1=IP1:2888:3888中，IP1指的是Zookeeper服务器的IP地址，2888为组成zookeeper服务器之间的通信端口，3888为用来选举leader的端口。由于伪集群模式中，我们使用的是同一台服务器，也就是说，需要在单台机器上运行多个zookeeper实例，所以我们必须要保证多个zookeeper实例的配置文件的client端口不能冲突。</p>
<blockquote>
<p>server.A=B:C:D：其中A是一个数字，代表第几号服务器，B是服务器的ip地址，C表示服务器与群集中的“领导者”交换信息的端口；当领导者失效后，D表示用来执行选举时服务器相互通信的端口。所以说伪集群的模式下，每个zookeeper实例需要保证clientPort、C、D三个端口都要不同，否则zookeeper服务将启动报错。</p>
</blockquote>
<p>首先先将<code>zookeeper-3.4.10.tar.gz</code>分别解压到server1，server2，server3目录下，执行如下的命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf zookeeper-3.4.10.tar.gz /home/leeyom/develop-tools/zookeeper_cluster/server1</span><br><span class="line">sudo tar -zxvf zookeeper-3.4.10.tar.gz /home/leeyom/develop-tools/zookeeper_cluster/server2</span><br><span class="line">sudo tar -zxvf zookeeper-3.4.10.tar.gz /home/leeyom/develop-tools/zookeeper_cluster/server3</span><br></pre></td></tr></table></figure>
<ul>
<li>在<code>server1</code>、<code>server2</code>、<code>server3</code>目录下先创建<code>data</code>和<code>dataLog</code>目录，然后在<code>server1/data/</code>目录下创建文件myid文件，并写入“1”，同样在<code>server2/data/</code>，目录下创建文件myid，并写入“2”，server3进行同样的操作。</li>
<li>然后分别在<code>server1/conf/</code>、<code>server2/conf/</code>、<code>server3/conf/</code>目录下创建<code>zoo.cfg</code>配置文件，三个配置文件如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Server 1</span><br><span class="line">tickTime=2000</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">dataDir=/home/leeyom/develop-tools/zookeeper_cluster/server1/data</span><br><span class="line">dataLogDir=/home/leeyom/develop-tools/zookeeper_cluster/server1/dataLog</span><br><span class="line">clientPort=2181</span><br><span class="line">server.1= 127.0.0.1:2888:3888</span><br><span class="line">server.2= 127.0.0.1:2889:3889</span><br><span class="line">server.3= 127.0.0.1:2890:3890</span><br><span class="line">maxClientCnxns=60</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Server 2</span><br><span class="line">tickTime=2000</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">dataDir=/home/leeyom/develop-tools/zookeeper_cluster/server2/data</span><br><span class="line">dataLogDir=/home/leeyom/develop-tools/zookeeper_cluster/server2/dataLog</span><br><span class="line">clientPort=2182</span><br><span class="line">server.1= 127.0.0.1:2888:3888</span><br><span class="line">server.2= 127.0.0.1:2889:3889</span><br><span class="line">server.3= 127.0.0.1:2890:3890</span><br><span class="line">maxClientCnxns=60</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Server 3</span><br><span class="line">tickTime=2000</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">dataDir=/home/leeyom/develop-tools/zookeeper_cluster/server3/data</span><br><span class="line">dataLogDir=/home/leeyom/develop-tools/zookeeper_cluster/server3/dataLog</span><br><span class="line">clientPort=2183</span><br><span class="line">server.1= 127.0.0.1:2888:3888</span><br><span class="line">server.2= 127.0.0.1:2889:3889</span><br><span class="line">server.3= 127.0.0.1:2890:3890</span><br><span class="line">maxClientCnxns=60</span><br></pre></td></tr></table></figure>
<p>以上便是伪集群模式下的配置。</p>
<h1 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h1><ol>
<li><p>单机模式：</p>
<ul>
<li>进入到zookeeper的安装目录下的<code>bin</code>目录下。</li>
<li>执行命令：<code>bash zkServer.sh start</code></li>
<li><p>若出现如下的内容，不要以为就启动成功了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /home/leeyom/develop-tools/zookeeper-3.4.10/bin/../conf/zoo.cfg</span><br><span class="line">Starting zookeeper ... STARTED</span><br></pre></td></tr></table></figure>
<p>继续执行：<code>bash zkServer.sh status</code>，查看启动状态，若出现如下内容，才说明zookeeper服务才是真的启动成功，否则都是启动失败：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /home/leeyom/develop-tools/zookeeper-3.4.10/bin/../conf zoo.cfg</span><br><span class="line">Mode: standalone</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>集群模式下需要用户在每台 ZooKeeper 机器上运行单机模式下的命令，这里不再赘述。</p>
</li>
<li><p>在集群伪分布模式下，按先后顺序依次启动<code>Server1</code>、<code>Server2</code>、<code>Server3</code>。这里拿<code>Server1</code>示例。</p>
<ul>
<li>进入到<code>server1/bin</code>目录下。</li>
<li>执行<code>bash zkServer.sh start</code>命令。</li>
<li>出现<code>Starting zookeeper ...STARTED</code>提示，说明服务启动成功。</li>
</ul>
</li>
<li><p>其他命令，需要进入到<code>zookeeper-3.4.10/bin</code>目录下，然后执行如下命令：</p>
<ul>
<li>查看ZK服务状态: <code>bash zkServer.sh status</code></li>
<li>停止ZK服务：<code>bash zkServer.sh stop</code></li>
<li>重启ZK服务：<code>bash zkServer.sh restart</code></li>
</ul>
</li>
</ol>
<h1 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h1><p>因为我实验的环境是ubuntu桌面版的linux系统，我是用普通账户登录的，我之前是将zookeeper安装到<code>/usr/local/develop-tools</code>文件夹下，然后执行命令：<code>sudo bash zkServer.sh start</code>启动服务。虽然说终端打印了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /usr/local/develop-tools/zookeeper-3.4.10/bin/../conf/zoo.cfg</span><br><span class="line">Starting zookeeper ... STARTED</span><br></pre></td></tr></table></figure>
<p>我便以为服务启动了，其实是错误的，此时服务并没有启动，由于权限的问题，当我启动服务的时候，zookeeper在<code>/usr/local</code>目录下没有读写权限，所以导致服务启动失败。具体的解决办法是：</p>
<ul>
<li>方式一：<code>cd /usr/local/</code>目录下，执行chmod命令增加权限，然后再次启动。<ul>
<li><code>chmod a+xwr zookeeper-3.4.10/</code></li>
</ul>
</li>
<li>方式二：将zookeeper安装到<code>/home/leeyom/</code>目录下面，这样zookeeper不会出现读写权限的问题。</li>
</ul>
<p>所以我们在启动zookeeper服务的时候，最好要用<code>bash zkServer.sh status</code>命令检查下zookeeper服务状态，确保zookeeper服务启动。</p>

      
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/11/08/zookeeper-install/">zookeeper安装教程</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 Leeyom 的个人博客">Leeyom</a></p>
        <p><span>发布时间:</span>2017年11月08日 - 21时26分</p>
        <p><span>最后更新:</span>2017年12月19日 - 22时01分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/11/08/zookeeper-install/" title="zookeeper安装教程">http://leeyom.top/2017/11/08/zookeeper-install/</a>
            <span class="copy-path" data-clipboard-text="原文: http://leeyom.top/2017/11/08/zookeeper-install/　　作者: Leeyom" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/2017/11/12/linux-note/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Linux折腾笔记（不间断更新）
        
      </div>
    </a>
  
  
    <a href="/2017/11/04/fontend-backend-separation/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">关于前后端分离的思考和总结</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#系统需求"><span class="toc-number">1.</span> <span class="toc-text"><a href="#&#x7CFB;&#x7EDF;&#x9700;&#x6C42;" class="headerlink" title="&#x7CFB;&#x7EDF;&#x9700;&#x6C42;"></a>&#x7CFB;&#x7EDF;&#x9700;&#x6C42;</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#支持平台"><span class="toc-number">1.1.</span> <span class="toc-text"><a href="#&#x652F;&#x6301;&#x5E73;&#x53F0;" class="headerlink" title="&#x652F;&#x6301;&#x5E73;&#x53F0;"></a>&#x652F;&#x6301;&#x5E73;&#x53F0;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#运行环境"><span class="toc-number">1.2.</span> <span class="toc-text"><a href="#&#x8FD0;&#x884C;&#x73AF;&#x5883;" class="headerlink" title="&#x8FD0;&#x884C;&#x73AF;&#x5883;"></a>&#x8FD0;&#x884C;&#x73AF;&#x5883;</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#下载"><span class="toc-number">2.</span> <span class="toc-text"><a href="#&#x4E0B;&#x8F7D;" class="headerlink" title="&#x4E0B;&#x8F7D;"></a>&#x4E0B;&#x8F7D;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#安装方式"><span class="toc-number">3.</span> <span class="toc-text"><a href="#&#x5B89;&#x88C5;&#x65B9;&#x5F0F;" class="headerlink" title="&#x5B89;&#x88C5;&#x65B9;&#x5F0F;"></a>&#x5B89;&#x88C5;&#x65B9;&#x5F0F;</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#单机模式"><span class="toc-number">3.1.</span> <span class="toc-text"><a href="#&#x5355;&#x673A;&#x6A21;&#x5F0F;" class="headerlink" title="&#x5355;&#x673A;&#x6A21;&#x5F0F;"></a>&#x5355;&#x673A;&#x6A21;&#x5F0F;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#集群模式"><span class="toc-number">3.2.</span> <span class="toc-text"><a href="#&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;" class="headerlink" title="&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;"></a>&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#伪集群模式"><span class="toc-number">3.3.</span> <span class="toc-text"><a href="#&#x4F2A;&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;" class="headerlink" title="&#x4F2A;&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;"></a>&#x4F2A;&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#启动服务"><span class="toc-number">4.</span> <span class="toc-text"><a href="#&#x542F;&#x52A8;&#x670D;&#x52A1;" class="headerlink" title="&#x542F;&#x52A8;&#x670D;&#x52A1;"></a>&#x542F;&#x52A8;&#x670D;&#x52A1;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#遇到的问题"><span class="toc-number">5.</span> <span class="toc-text"><a href="#&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;" class="headerlink" title="&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;"></a>&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>







    
        <div id="gitments"></div>
<script src="/js/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
      id: window.location.pathname,
      owner: 'wangleeyom',
      repo: 'wangleeyom.github.io',
      oauth: {
        client_id: '157bc01270305e8af592',
        client_secret: 'ada3e7cf31cbe08c9c4bd7cd1af069096342409d',
      },
    })
    gitment.render('gitments')
</script>
    



    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/11/12/linux-note/" title="上一篇: Linux折腾笔记（不间断更新）">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2017/11/04/fontend-backend-separation/" title="下一篇: 关于前后端分离的思考和总结">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/12/14/docker-preliminary-study/">Docker初探</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/30/life-mac-tools-collection/">mac重装系统软件清单</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/12/linux-note/">Linux折腾笔记（不间断更新）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/08/zookeeper-install/">zookeeper安装教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/04/fontend-backend-separation/">关于前后端分离的思考和总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/15/tech-java-book-list/">Java开发工程师进阶书单</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/27/tech-rbac-model/">RBAC权限模型</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/26/tech-hexo-error/">hexo指令错误修复记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/25/tech-swagger-annotation/">swagger注解总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/23/tech-spring-mvc-swagger2/">Spring MVC中使用Swagger2构建Restful API</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/20/tech-spring-boot-note/">spring boot 学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/09/tech-java-Integer-cache-problem/">java 中 Integer 的缓存问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/01/tech-maven-multi-module-ssm/">Maven的多模块 Spring MVC + Spring + Mybatis 项目的搭建</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/23/tech-java-activemq-note/">Java消息中间件ActiveMQ学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/20/tech-shutdown-tomcat-oom-error/">Tomcat关闭报内存溢出异解决方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/17/tech-hexo-theme-change/">Hexo主题更换记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/27/tech-trigger-procedure-note/">触发器与存储过程讲义</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/04/tech-db-three/">数据库三范式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/10/tech-jvm-summary-note/">《深入理解Java虚拟机》总结笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/tech-spring-hibernateTemplate-solution/">Spring注解异常'sessionFactory' or 'hibernateTemplate' is required的解决方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/31/life-2016-summary/">我的2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/22/tech-centos-fastDFS/">centOS上搭建FastDFS图片服务器教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/15/tech-nginx-summary/">nginx的反向代理与负载均衡总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/12/tech-intellij-idea/">IntelliJ IDEA 使用技巧汇总(长期更新)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/09/life-chrome-plugin/">chrome浏览器插件推荐</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/08/tech-centOS-nginx/">在centOS上安装nginx教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/05/tech-mybatis-pagehelper/">mybatis 分页插件PageHelper使用及总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/26/tech-easyui-datagrid/">easyUI datagrid 动态表头的实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/05/life-tuchuang-picu/">七牛云+U图床解决编博客插图麻烦事儿</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/05/tech-hexo-github-error/">Hexo+Github博客css和js404导致博客页面空白</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/02/tech-Hibernate-addScalar-addEntity/">Hibernate SQL查询addScalar()和addEntity()区别</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/01/tech-sqlserver-oracle-recursion-diff/">sqlserver、oracle、MySQL 递归查询的区别</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/27/tech-pc-multi-tomact/">一台机子上面启动多个tomact的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/21/tech-easyui-tree/">easyUI tree组件的构建以及异步加载</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/21/tech-db-find-neighbouring/">Oracle如何查询某条记录的上下两条记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/29/tech-hexo-advance/">hexo博客进阶教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/25/tech-hexo-github/">hexo+github搭建个人博客网站</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/23/life-hello-world/">Hello World</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2017 Leeyom
            </div>
            <div class="footer-right">
                Write the Code. Debug the World!
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
    <div style="text-align:center;margin:0 auto;padding-top:10px;position:relative;left:-30px;">
        <a href="http://www.miitbeian.gov.cn/" target="_blank">粤ICP备17147440号</a>
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 18;
            var backgroundimg = "url(/background/bg-" + backgroundnum +".jpg)";
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'leeyom-blog-space/Lobby'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
</html>